---
- name: Check the number of available CPUs
  assert:
    that:
      - ansible_processor_vcpus < 3
    msg: "the number of available CPUs {{ ansible_processor_vcpus }} is less than the required 2"

- name: Disable Swap
  shell: swapoff -a
  become: true

- name: Comment Swap entries in /etc/fstab
  replace:
    path: /etc/fstab
    regexp: '(^/.* swap .*)'
    replace: '# \1'
  become: true